# validated: 2024-10-07 TW e53db15a2003 software/hardware-apis/sensors/limit-switch.rst
block0: |
  val topLimitSwitch = DigitalInput(0)
  
  val bottomLimitSwitch = DigitalInput(1)
  
  val motor = PWMVictorSPX(0)
  
  val joystick = Joystick(0)
  
  override fun teleopPeriodic() {
    setMotorSpeed(joystick.getRawAxis(2))
  }
  
  fun setMotorSpeed(speed: Double) {
    if (speed > 0) {
      if (topLimitSwitch.get()) {
        // We are going up and top limit is tripped so stop
        motor.set(0.0)
      } else {
        // We are going up but top limit is not tripped so go at commanded speed
        motor.set(speed)
      }
    } else {
      if (bottomLimitSwitch.get()) {
        // We are going down and bottom limit is tripped so stop
        motor.set(0.0)
      } else {
        // We are going down but bottom limit is not tripped so go at commanded speed
        motor.set(speed)
      }
    }
  }
